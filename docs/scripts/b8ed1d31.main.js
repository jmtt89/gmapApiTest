function loadMap(a,b){map=new google.maps.Map(document.getElementById("map"),{center:{lat:a,lng:b},zoom:16}),startP=new google.maps.Marker({map:null,icon:{path:google.maps.SymbolPath.CIRCLE,scale:10}}),endP=new google.maps.Marker({map:null,icon:{path:google.maps.SymbolPath.CIRCLE,scale:10}}),geodesicPoly=new google.maps.Polyline({strokeColor:"#CC0099",strokeOpacity:1,strokeWeight:3,geodesic:!0,map:null}),marker=new google.maps.Marker({map:null,position:{lat:a,lng:b}}),marker.setAnimation(google.maps.Animation.BOUNCE)}function focusMap(a,b,c){marker.setMap(map),startP.setMap(null),endP.setMap(null),geodesicPoly.setMap(null),marker.setPosition({lat:a,lng:b}),map.setCenter({lat:a,lng:b}),map.setZoom(c)}function calcDistance(a,b){marker.setMap(null),startP.setMap(map),endP.setMap(map),geodesicPoly.setMap(map),startP.setPosition(a),endP.setPosition(b),geodesicPoly.setPath([a,b]);var c=google.maps.geometry.spherical.computeDistanceBetween(startP.getPosition(),endP.getPosition());return console.log(c),c}function addMarker(a,b){for(var c=new Number(a).valueOf(),d=new Number(b).valueOf(),e=!1,f=0;f<markers.length;f++){var g=markers[f];if(c.toFixed(8)==g.getPosition().lat().toFixed(8)&&d.toFixed(8)==g.getPosition().lng().toFixed(8)){e=!0;break}}if(!e){var g=new google.maps.Marker({label:""+(markers.length+1),position:new google.maps.LatLng({lat:c,lng:d}),map:map});markers.push(g),addDisplayMarker(a,b)}}function addDisplayMarker(a,b){var c=markers.length-1,d='<tr id="marker-'+c+'"><td>'+a+"</td><td>"+b+'</td><td><input class="checkbox" index="'+c+'" type="checkbox" checked/></td></tr>';$("#markerTable > tbody").append(d),$("#markerTable .checkbox").change(function(){var a=parseInt($(this).attr("index"));this.checked?showMarker(a):hideMarker(a)})}function hideMarker(a){markers[a].setMap(null)}function showMarker(a){markers[a].setMap(map)}function addCircle(a,b,c,d){var d=d||"#FF0000",e=new google.maps.Circle({strokeColor:d,strokeOpacity:.8,strokeWeight:2,fillColor:d,fillOpacity:.15,map:map,center:{lat:a,lng:b},radius:c});circles.push(e)}function hideCircle(a){circles[a].setMap(null)}function showCircle(a){circles[a].setMap(map)}function initMap(a){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(a){lat=a.coords.latitude,lon=a.coords.longitude,$("#lat").val(lat),$("#lng").val(lon),loadMap(lat,lon)}):(lat=0,lon=0,loadMap())}function parserCoordinate(a,b,c){if(b.test(a)){var d,e=a.split(b);return d=e[e.length-1],new Number(d.split(c)[0])}return null}function processMarker(a){$("#showPreview > tbody").empty();for(var b,c,d=$("#latitudeLabel").val(),e=$("#longitudeLabel").val(),f=$("#assignator").val(),g=new RegExp("("+d+")("+f+")"),h=new RegExp("("+e+")("+f+")"),i=$("#separator").val(),j=new RegExp("("+i+")"),k=0;k<a.length;k++){var l=a[k];b=parserCoordinate(l,g,j),c=parserCoordinate(l,h,j),b&&c?addPreloadCoordinateToView(b,c):console.log("NOT Latitude or Longitude in line"+k)}$("#showPreview").show()}function addPreloadCoordinateToView(a,b){var c="<tr><td>"+a+"</td><td>"+b+"</td></tr>";$("#showPreview > tbody").append(c)}console.log("'Allo 'Allo!");var map,marker,refreshIntervalId,lat,lon,loadByFile=!0,geodesicPoly,startP,endP,circles=[],markers=[];$(function(){$.ajaxSetup({cache:!1}),$("#showPeriod").hide(),$("#showPreview").hide(),loadByFile?($("#markerByFile").show(),$("#markerByUrL").hide()):($("#markerByFile").hide(),$("#markerByUrL").show()),$("#sendFocus").click(function(a){a.preventDefault(),lat=parseFloat($("#lat").val()),lon=parseFloat($("#lng").val()),focusMap(lat,lon,16)}),$("#calcDistance").click(function(){event.preventDefault();var a={lat:parseFloat($("#latA").val()),lng:parseFloat($("#lngA").val())},b={lat:parseFloat($("#latB").val()),lng:parseFloat($("#lngB").val())},c=calcDistance(a,b);$("#distanceM").val(c+"")}),$("#newMarker").click(function(){var a=parseFloat($("#latNewMarker").val()),b=parseFloat($("#lngNewMarker").val());addMarker(a,b),$("#latNewMarker").val(""),$("#lngNewMarker").val("")}),$("#newCircle").click(function(){var a=parseFloat($("#latNewCircle").val()),b=parseFloat($("#lngNewCircle").val()),c=parseFloat($("#radNewCircle").val()),d=$("#colNewCircle").val(),e=circles.length;addCircle(a,b,c,d),$("#latNewCircle").val(""),$("#lngNewCircle").val(""),$("#radNewCircle").val("");var f='<tr id="circle-'+e+'"><td>'+a+"</td><td>"+b+"</td><td>"+c+'</td><td><input class="checkbox" index="'+e+'" type="checkbox" checked/></td></tr>';$("#circleTable > tbody").append(f),$("#circleTable .checkbox").change(function(){var a=parseInt($(this).attr("index"));this.checked?showCircle(a):hideCircle(a)})}),$("#makersFile").change(function(){var a=new FileReader;a.onload=function(a){var b=a.target.result,c=b.split(/\r\n|\n/);processMarker(c)},a.onerror=function(a){console.log(a.target.error.name)};var b=this.files[0];a.readAsText(b)}),$("#markerByUrL").submit(function(a){a.preventDefault();var b=$("#markerUrl").val();$.get(b,function(a){var b=a.split(/\r\n|\n/);processMarker(b)})}),$("#showLoadByFile").click(function(){loadByFile=!0,$("#showLoadByFile").addClass("btn-primary"),$("#showLoadByFile").removeClass("btn-default"),$("#showLoadByUrl").removeClass("btn-primary"),$("#showLoadByUrl").addClass("btn-default"),$("#markerByFile").show(),$("#markerByUrL").hide()}),$("#showLoadByUrl").click(function(){loadByFile=!1,$("#showLoadByFile").removeClass("btn-primary"),$("#showLoadByFile").addClass("btn-default"),$("#showLoadByUrl").addClass("btn-primary"),$("#showLoadByUrl").removeClass("btn-default"),$("#markerByFile").hide(),$("#markerByUrL").show()}),$("#markerSingleUse").change(function(a){$("#showPeriod").toggle()}),$("#loadMarkers").click(function(){var a=$("#markerSingleUse").prop("checked");if(loadByFile||a)$("#showPreview > tbody > tr").each(function(a,b){var c=$(b).find("td").eq(0).html(),d=$(b).find("td").eq(1).html();addMarker(c,d)});else if(!a){var b=new Number($("#markerLoadPeriod").val());refreshIntervalId=setInterval(function(){console.log("Interval Call");var a=$("#markerUrl").val();$.get(a,function(a){for(var b,c,d=$("#latitudeLabel").val(),e=$("#longitudeLabel").val(),f=$("#assignator").val(),g=new RegExp("("+d+")("+f+")"),h=new RegExp("("+e+")("+f+")"),i=$("#separator").val(),j=new RegExp("("+i+")"),k=a.split(/\r\n|\n/),l=0;l<k.length;l++){var m=k[l];b=parserCoordinate(m,g,j),c=parserCoordinate(m,h,j),b&&c&&(console.log("lat:"+b+",lng:"+c),addMarker(b,c))}})},b)}})});